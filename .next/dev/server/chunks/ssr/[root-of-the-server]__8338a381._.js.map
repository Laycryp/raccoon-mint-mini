{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/WinDows/Desktop/Web3-Projects/quantum-mints-mini/src/lib/constants.ts"],"sourcesContent":["// src/lib/constants.ts\r\nexport const CHAIN_ID = 8453; // Base mainnet\r\nexport const CONTRACT_ADDRESS = '0x01abca5d698656428738f3b8e8c945fd9d717aab' as const;\r\nexport const USDC_ADDRESS     = '0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913' as const;\r\nexport const USDC_DECIMALS = 6;\r\nexport const MAX_QTY_UI = 5;\r\n"],"names":[],"mappings":"AAAA,uBAAuB;;;;;;;;;;;;;AAChB,MAAM,WAAW,MAAM,eAAe;AACtC,MAAM,mBAAmB;AACzB,MAAM,eAAmB;AACzB,MAAM,gBAAgB;AACtB,MAAM,aAAa","debugId":null}},
    {"offset": {"line": 128, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/WinDows/Desktop/Web3-Projects/quantum-mints-mini/src/lib/ipfs.ts"],"sourcesContent":["// src/lib/ipfs.ts\r\nexport function ipfsToHttp(uri: string) {\r\n  if (!uri) return uri;\r\n  if (uri.startsWith('ipfs://')) {\r\n    return uri.replace('ipfs://', 'https://ipfs.io/ipfs/');\r\n  }\r\n  return uri;\r\n}\r\n"],"names":[],"mappings":"AAAA,kBAAkB;;;;;AACX,SAAS,WAAW,GAAW;IACpC,IAAI,CAAC,KAAK,OAAO;IACjB,IAAI,IAAI,UAAU,CAAC,YAAY;QAC7B,OAAO,IAAI,OAAO,CAAC,WAAW;IAChC;IACA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 144, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/WinDows/Desktop/Web3-Projects/quantum-mints-mini/src/app/my-nfts/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useMemo, useState } from 'react';\r\nimport { useAccount, usePublicClient } from 'wagmi';\r\nimport { ConnectButton } from '@rainbow-me/rainbowkit';\r\nimport { sdk } from '@farcaster/miniapp-sdk';\r\nimport { CONTRACT_ADDRESS } from '@/lib/constants';\r\nimport { ipfsToHttp } from '@/lib/ipfs';\r\n\r\n// حدث Transfer قياسي مختصر بدون ملف منفصل\r\nconst TransferEvent = {\r\n  type: 'event',\r\n  name: 'Transfer',\r\n  inputs: [\r\n    { indexed: true, name: 'from', type: 'address' },\r\n    { indexed: true, name: 'to', type: 'address' },\r\n    { indexed: true, name: 'tokenId', type: 'uint256' },\r\n  ],\r\n} as const;\r\n\r\n// baseURI من المعطيات التي زوّدتنا بها\r\nconst BASE_URI = 'ipfs://bafybeif4nhbmbypovzvr2wz5p2kfm2wy2simfbbxawmkk2j3cjp4guxsgy/';\r\n\r\ntype Meta = Record<string, any>;\r\n\r\nexport default function MyNftsPage() {\r\n  const { address, isConnected } = useAccount();\r\n  const publicClient = usePublicClient();\r\n\r\n  // Farcaster ready()\r\n  useEffect(() => {\r\n    if (typeof window === 'undefined') return;\r\n    const appUrl = process.env.NEXT_PUBLIC_APP_URL;\r\n    const sameOrigin = !appUrl || window.location.origin === appUrl;\r\n    if (sameOrigin) sdk.actions.ready().catch(console.error);\r\n  }, []);\r\n\r\n  const [tokenId, setTokenId] = useState<bigint | null>(null);\r\n  const [imageUrl, setImageUrl] = useState<string | null>(null);\r\n  const [metadataUrl, setMetadataUrl] = useState<string | null>(null);\r\n  const [metadata, setMetadata] = useState<Meta | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [err, setErr] = useState<string | null>(null);\r\n\r\n  // اجلب آخر NFT سكّيته (أحدث Transfer إلى محفظتك)\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n    async function run() {\r\n      if (!isConnected || !address || !publicClient) return;\r\n      setLoading(true);\r\n      setErr(null);\r\n      setTokenId(null);\r\n      setImageUrl(null);\r\n      setMetadata(null);\r\n      try {\r\n        const logs = await publicClient.getLogs({\r\n          address: CONTRACT_ADDRESS,\r\n          // @ts-ignore\r\n          event: TransferEvent,\r\n          // حصر اللوجات إلى عنوانك كمستلم\r\n          // @ts-ignore\r\n          args: { to: address },\r\n        });\r\n\r\n        if (!logs.length) {\r\n          if (!cancelled) setErr('لا توجد عمليات Mint (Transfer) إلى محفظتك حتى الآن.');\r\n          return;\r\n        }\r\n\r\n        // اختر الأحدث بناءً على (blockNumber, logIndex)\r\n        const latest = logs.slice().sort((a: any, b: any) => {\r\n          if (a.blockNumber === b.blockNumber) return Number(a.logIndex - b.logIndex);\r\n          return Number(a.blockNumber - b.blockNumber);\r\n        })[logs.length - 1] as any;\r\n\r\n        const tid: bigint = latest.args.tokenId;\r\n        const metaUrl = ipfsToHttp(`${BASE_URI}${tid}.json`);\r\n\r\n        // اجلب الميتاداتا\r\n        const res = await fetch(metaUrl, { cache: 'no-store' });\r\n        if (!res.ok) throw new Error(`Metadata HTTP ${res.status}`);\r\n        const json = (await res.json()) as Meta;\r\n\r\n        const img = ipfsToHttp(\r\n          (json.image as string) ||\r\n          (json.image_url as string) ||\r\n          ''\r\n        );\r\n\r\n        if (!cancelled) {\r\n          setTokenId(tid);\r\n          setMetadataUrl(metaUrl);\r\n          setMetadata(json);\r\n          setImageUrl(img || null);\r\n        }\r\n      } catch (e: any) {\r\n        if (!cancelled) setErr(e?.message || String(e));\r\n      } finally {\r\n        if (!cancelled) setLoading(false);\r\n      }\r\n    }\r\n    run();\r\n    return () => { cancelled = true; };\r\n  }, [isConnected, address, publicClient]);\r\n\r\n  const prettyMeta = useMemo(() => {\r\n    if (!metadata) return '';\r\n    try {\r\n      return JSON.stringify(metadata, null, 2);\r\n    } catch {\r\n      return String(metadata);\r\n    }\r\n  }, [metadata]);\r\n\r\n  return (\r\n    <main className=\"min-h-screen bg-neutral-950 text-white\">\r\n      <header className=\"flex items-center justify-between p-4 border-b border-neutral-800\">\r\n        <div className=\"text-lg font-semibold\">RACCOON-MINT — My NFT</div>\r\n        <ConnectButton />\r\n      </header>\r\n\r\n      <section className=\"max-w-xl mx-auto p-6 grid gap-6\">\r\n        {!isConnected ? (\r\n          <p className=\"text-sm text-neutral-300\">\r\n            Connect your wallet to view your latest minted NFT.\r\n          </p>\r\n        ) : loading ? (\r\n          <p className=\"text-sm text-neutral-300\">Loading your latest minted NFT…</p>\r\n        ) : err ? (\r\n          <p className=\"text-sm text-amber-300\">⚠️ {err}</p>\r\n        ) : tokenId === null ? (\r\n          <p className=\"text-sm text-neutral-300\">No NFT found.</p>\r\n        ) : (\r\n          <>\r\n            {/* الصورة فقط */}\r\n            <article className=\"rounded-2xl overflow-hidden border border-neutral-800 bg-neutral-900\">\r\n              <div className=\"aspect-square bg-neutral-800 flex items-center justify-center\">\r\n                {imageUrl ? (\r\n                  // eslint-disable-next-line @next/next/no-img-element\r\n                  <img\r\n                    src={imageUrl}\r\n                    alt={metadata?.name ?? `#${tokenId.toString()}`}\r\n                    className=\"w-full h-full object-cover\"\r\n                  />\r\n                ) : (\r\n                  <span className=\"text-xs text-neutral-400 p-2 text-center\">\r\n                    No image in metadata\r\n                  </span>\r\n                )}\r\n              </div>\r\n              <div className=\"p-4 text-sm space-y-1\">\r\n                <div className=\"font-mono\">Token #{tokenId.toString()}</div>\r\n                {metadataUrl && (\r\n                  <a\r\n                    className=\"text-cyan-300 hover:underline\"\r\n                    href={metadataUrl}\r\n                    target=\"_blank\"\r\n                    rel=\"noreferrer\"\r\n                  >\r\n                    Open metadata JSON →\r\n                  </a>\r\n                )}\r\n              </div>\r\n            </article>\r\n\r\n            {/* الميتاداتا أسفل الصورة */}\r\n            <div className=\"rounded-2xl border border-neutral-800 bg-neutral-900/60 p-4\">\r\n              <h3 className=\"font-semibold mb-2\">Metadata</h3>\r\n              <pre className=\"text-xs text-neutral-200 overflow-auto whitespace-pre-wrap\">\r\n{prettyMeta}\r\n              </pre>\r\n            </div>\r\n          </>\r\n        )}\r\n      </section>\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}